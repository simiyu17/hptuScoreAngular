<mat-stepper linear #stepper>
  <mat-step [stepControl]="firstFormGroup" [editable]="true">
    <form [formGroup]="firstFormGroup">
      <ng-template matStepLabel>Fill out your name</ng-template>
      <mat-form-field>
        <mat-label>countyCode</mat-label>
        <input matInput formControlName="countyCode" placeholder="Last name, First name" required>
      </mat-form-field>
      <mat-form-field>
        <mat-label>assessmentYear</mat-label>
        <input matInput formControlName="assessmentYear" placeholder="Last name, First name" required>
      </mat-form-field>
      <mat-form-field>
        <mat-label>assessmentQuarter</mat-label>
        <input matInput formControlName="assessmentQuarter" placeholder="Last name, First name" required>
      </mat-form-field>
      <mat-form-field>
        <mat-label>assessmentLevel</mat-label>
        <input matInput formControlName="assessmentLevel" placeholder="Last name, First name" required>
      </mat-form-field>
      <mat-form-field>
        <mat-label>countyName</mat-label>
        <input matInput formControlName="countyName" placeholder="Last name, First name" required>
      </mat-form-field>
      <div>
        <button mat-button matStepperNext>Next</button>
      </div>
    </form>
  </mat-step>
  @for (pillar of pillars; track pillar.id) {
  <mat-step>
    <ng-template matStepLabel>{{pillar.pillarName}}</ng-template>




    <div class="pillars-content">

      <div class="pillars-table-content">
        <mat-toolbar>
          <span>Pillars</span>
          <span class="pillar-toolbar-spacer"></span>
        </mat-toolbar>

        <div class="pillars-table">

          <table mat-table [dataSource]="pillar.dataSource">

            <!-- category Column -->
            <ng-container matColumnDef="category">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Pillar Category </th>
              <td mat-cell *matCellDef="let row"> {{row.category}} </td>
            </ng-container>

            <!-- choiceScore Column -->
            <ng-container matColumnDef="choiceScore">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Choice Score </th>
              <td mat-cell *matCellDef="let row;let i = index">
                <mat-radio-group aria-labelledby="example-radio-group-label" class="example-radio-group" [formControl]="getControl(pillar, i,'choiceScore')">
                  <mat-radio-button class="example-radio-button" [value]="row.choiceOneScore">{{row.choiceOne}}</mat-radio-button>
                  <mat-radio-button class="example-radio-button" [value]="row.choiceTwoScore">{{row.choiceTwo}}</mat-radio-button>
                  <mat-radio-button class="example-radio-button" [value]="row.choiceThreeScore">{{row.choiceThree}}</mat-radio-button>
                  <mat-radio-button class="example-radio-button" [value]="row.choiceFourScore">{{row.choiceFour}}</mat-radio-button>
                </mat-radio-group>
              </td>
            </ng-container>

            <!-- scoreRemarks Column -->
            <ng-container matColumnDef="scoreRemarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Remarks </th>
              <td mat-cell *matCellDef="let row;let i = index"> 
                <input
        type="text"
        matInput
        [formControl]="getControl(pillar, i,'scoreRemarks')"
      />
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">No data matching the filter</td>
            </tr>
          </table>

        </div>

      </div>
    </div>





    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button matStepperNext>Next</button>
    </div>
  </mat-step>
  } @empty {
  Empty list of Pillars
  }
  <mat-step>
    <ng-template matStepLabel>Done</ng-template>
    <p>You are now done.</p>
    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button (click)="submitScores()">Submit</button>
    </div>
  </mat-step>
</mat-stepper>